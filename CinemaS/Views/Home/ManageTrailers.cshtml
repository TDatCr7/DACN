@model CinemaS.Models.ViewModels.TrailerManageVM
@{
    ViewData["Title"] = "Quản lý trailer trang chủ";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .island-shell {
        max-width: 1200px;
        margin: 0 auto;
    }

    .island-header {
        background: radial-gradient(circle at 0 0, rgba(248,113,113,.4), transparent 60%), radial-gradient(circle at 100% 0, rgba(59,92,204,.4), transparent 60%);
        border-radius: 999px;
        padding: 14px 22px;
        border: 1px solid rgba(255,255,255,.12);
        box-shadow: 0 16px 40px rgba(0,0,0,.45);
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 28px;
        backdrop-filter: blur(16px);
    }

    .island-header-title {
        font-weight: 800;
        letter-spacing: .5px;
        text-transform: uppercase;
        color: #fff;
    }

    .island-header-sub {
        font-size: 13px;
        color: var(--muted);
    }

    .island-header-actions .btn {
        border-radius: 999px;
    }

    .card-island {
        background: radial-gradient(circle at 100% 0, rgba(124,58,237,.35), transparent 60%), linear-gradient(145deg, rgba(8,10,30,.96), rgba(5,8,25,.98));
        border-radius: 24px;
        border: 1px solid rgba(255,255,255,.08);
        padding: 18px 20px;
        box-shadow: 0 18px 45px rgba(0,0,0,.6);
        margin-bottom: 22px;
    }

    .trailer-row {
        border-radius: 18px;
        border: 1px solid rgba(148,163,255,.18);
        background: rgba(15,23,42,.8);
        padding: 10px 12px;
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .trailer-title {
        font-weight: 700;
        color: #e5e7ff;
        margin-bottom: 2px;
    }

    .trailer-link {
        font-size: 13px;
        color: #93c5fd;
        word-break: break-all;
    }

    .badge-pill {
        border-radius: 999px;
        font-size: 11px;
        font-weight: 700;
        padding: 4px 8px;
        text-transform: uppercase;
        letter-spacing: .4px;
    }

    .badge-on {
        background: radial-gradient(circle at 0 0, rgba(52,211,153,.7), transparent 60%), rgba(15,23,42,1);
        color: #ecfeff;
        border: 1px solid rgba(52,211,153,.7);
    }

    .badge-off {
        background: radial-gradient(circle at 0 0, rgba(248,113,113,.7), transparent 60%), rgba(15,23,42,1);
        color: #fee2e2;
        border: 1px solid rgba(248,113,113,.7);
    }

    .pill-switch-small input[type="checkbox"] {
        display: none;
    }

    .pill-switch-small label {
        position: relative;
        display: inline-flex;
        align-items: center;
        width: 56px;
        height: 26px;
        border-radius: 999px;
        background: rgba(15,23,42,.95);
        border: 1px solid rgba(148,163,255,.55);
        cursor: pointer;
        padding: 2px;
        transition: all .25s ease;
    }

    .pill-switch-small .handle {
        width: 22px;
        height: 22px;
        border-radius: 999px;
        background: linear-gradient(145deg, #f97373, #fb7185);
        box-shadow: 0 6px 16px rgba(0,0,0,.6);
        transform: translateX(0);
        transition: all .25s ease;
    }

    .pill-switch-small span.txt {
        position: absolute;
        right: 8px;
        font-size: 10px;
        font-weight: 700;
        text-transform: uppercase;
        color: #f97373;
        letter-spacing: .4px;
    }

    .pill-switch-small input[type="checkbox"]:checked + label {
        background: rgba(15,23,42,.95);
        border-color: rgba(52,211,153,.7);
    }

        .pill-switch-small input[type="checkbox"]:checked + label .handle {
            transform: translateX(28px);
            background: linear-gradient(145deg, #22c55e, #4ade80);
        }

        .pill-switch-small input[type="checkbox"]:checked + label span.txt {
            right: auto;
            left: 8px;
            color: #a5f3fc;
        }

    .page-island-nav {
        display: flex;
        justify-content: center;
        margin-top: 18px;
    }

    .page-island {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 10px;
        border-radius: 999px;
        background: radial-gradient(circle at 0 0, rgba(59,92,204,.45), transparent 60%), rgba(10,16,40,.98);
        border: 1px solid rgba(148,163,255,.45);
        box-shadow: 0 12px 32px rgba(0,0,0,.65);
    }

        .page-island a,
        .page-island span {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 999px;
            text-decoration: none;
            color: #e5e7ff;
            font-weight: 600;
        }

        .page-island .current {
            background: radial-gradient(circle at 0 0, rgba(248,113,113,.75), transparent 60%), linear-gradient(120deg, #7c3aed, #3b82f6);
            box-shadow: 0 0 14px rgba(248,113,113,.8);
        }

        .page-island .disabled {
            opacity: .4;
            cursor: default;
        }
</style>

<div class="island-shell">
    <div class="island-header">
        <div>
            <div class="island-header-title">
                Trailer Hot Home
            </div>
            <div class="island-header-sub">
                Chọn phim có trailer sẽ xuất hiện trong mục “Trailer hot” trên trang chủ.
            </div>
        </div>
        <div class="island-header-actions d-flex gap-2">
            <a asp-controller="Home" asp-action="EditBanner" class="btn btn-outline-info btn-sm">
                <i class="fa-solid fa-image me-1"></i> Banner Home
            </a>
            <a asp-controller="Home" asp-action="Index" class="btn btn-outline-light btn-sm">
                Trang chủ
            </a>
        </div>
    </div>

    <div class="card-island">
        <form asp-action="ManageTrailers" method="post">
            <input type="hidden" name="PageIndex" value="@Model.PageIndex" />

            @if (Model.Items.Any())
            {
                @for (int i = 0; i < Model.Items.Count; i++)
                {
                    var item = Model.Items[i];
                    <div class="trailer-row">
                        <div class="flex-grow-1">
                            <input type="hidden" name="Items[@i].MoviesId" value="@item.MoviesId" />
                            <input type="hidden" name="Items[@i].Title" value="@item.Title" />
                            <input type="hidden" name="Items[@i].TrailerLink" value="@item.TrailerLink" />

                            <div class="trailer-title text-truncate" title="@item.Title">
                                @item.Title
                            </div>
                            <div class="trailer-link small">
                                @item.TrailerLink
                            </div>
                        </div>
                        <div class="d-flex flex-column align-items-end gap-2">
                            <span class="badge-pill @(item.ShowOnHome ? "badge-on" : "badge-off")">
                                @(item.ShowOnHome ? "Đang hiện" : "Đang ẩn")
                            </span>
                            <div class="pill-switch-small">
                                <input type="checkbox"
                                       id="show_@item.MoviesId"
                                       name="Items[@i].ShowOnHome"
                                       value="true"
                                       @(item.ShowOnHome ? "checked" : "") />
                                <label for="show_@item.MoviesId">
                                    <div class="handle"></div>
                                    <span class="txt">Hiện</span>
                                </label>
                            </div>
                        </div>
                    </div>
                }

                @* phân trang trailer *@
                @if (Model.TotalPages > 1)
                {
                    <div class="page-island-nav">
                        <div class="page-island">
                            @if (Model.HasPreviousPage)
                            {
                                <a asp-action="ManageTrailers" asp-route-page="@(Model.PageIndex - 1)">« Trước</a>
                            }
                            else
                            {
                                <span class="disabled">« Trước</span>
                            }

                            @for (int i = 1; i <= Model.TotalPages; i++)
                            {
                                if (i == Model.PageIndex)
                                {
                                    <span class="current">@i</span>
                                }
                                else
                                {
                                    <a asp-action="ManageTrailers" asp-route-page="@i">@i</a>
                                }
                            }

                            @if (Model.HasNextPage)
                            {
                                <a asp-action="ManageTrailers" asp-route-page="@(Model.PageIndex + 1)">Sau »</a>
                            }
                            else
                            {
                                <span class="disabled">Sau »</span>
                            }
                        </div>
                    </div>
                }

                <div class="mt-3 d-flex justify-content-end">
                    <button type="submit" class="btn btn-primary rounded-pill px-4">
                        Lưu danh sách trailer hiển thị
                    </button>
                </div>
            }
            else
            {
                <div class="text-muted small">
                    Không tìm thấy phim nào có trailer (TrailerLink trống).
                </div>
            }
        </form>
    </div>
</div>
